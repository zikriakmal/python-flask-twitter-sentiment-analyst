{% extends 'base.html' %} {% block body %}

<div class="content-body">
  <div class="container-fluid">
    <div class="container ms-auto balya-container">
      <div class="card justify-content-center">
        <div class="card-body">
          <h5 class="card-title">statis</h5>
          <select class="mt-2 mb-3 form-control default-select" id="sel1">
            <option value="" selected disabled>Pilih Komentar</option>
            <option value="Jaringan Telkomsel">Jaringan Telkomsel</option>
            <option value="Kenyamanan Telkomsel">Kenyamanan Telkomsel</option>
            <option value="Layanan Telkomsel">Layanan Telkomsel</option>
            <option value="Internet Telkomsel">Internet Telkomsel</option>
            <option value="Harga Telkomsel">Harga Telkomsel</option>
          </select>
          <!-- coba2 ngepush ulang ma brooo -->
          <div class="row">
            <div class="col-md-6">
              <select class="mt-2 mb-3 form-control default-select" id="sel2">
                <option value="" selected disabled>Pilih Bulan</option>
                <option value="1">Bulan 1</option>
                <option value="2">Bulan 2</option>
                <option value="3">Bulan 3</option>
                <option value="4">Bulan 4</option>
                <option value="5">Bulan 5</option>
                <option value="6">Bulan 6</option>
                <option value="7">Bulan 7</option>
                <option value="8">Bulan 8</option>
                <option value="9">Bulan 9</option>
                <option value="10">Bulan 10</option>
                <option value="11">Bulan 11</option>
                <option value="12">Bulan 12</option>
              </select>
            </div>
            <div class="col-md-6">
              <select class="mt-2 mb-3 form-control default-select" id="sel3">
                <option value="" selected disabled>Pilih Tahun</option>
                <option value="2020">2020</option>
                <option value="2021">2021</option>
              </select>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col">
              <button id="showData" class="btn btn-primary">Show Data</button>
              <div style="display: none" class="w-100" id="data-crawl">
                <h3 class="mt-3">Data Komentar Tercrawl</h3>
                <div class="table-responsive mt-3">
                  <table id="example" class="display" style="min-width: 845px">
                    <thead>
                      <tr>
                        <th>Waktu</th>
                        <th>Username</th>
                        <th>Tweet</th>
                        <th>English</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
            <button id="sentimentData" class="btn btn-primary">Analisis Sentimen</button>
                <div style="display: none" class="w-100" id="data-sent">
                <h3 class="mt-3">Data Komentar Tercrawl</h3>
                <div class="table-responsive mt-3">
                  <table id="sentimentDataTable" class="display" style="min-width: 845px">
                    <thead>
                      <tr>
                        <th>Waktu</th>
                        <th>Username</th>
                        <th>Tweet</th>
                        <th>English</th>
                        <th>Sentiment</th>
                        <th>Polarity</th>
                                    
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
       
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %} {% block js %}
<script>
  const sel = $("#sel1");
  const sel2 = $("#sel2");
  const sel3 = $("#sel3");
  $("#showData").on("click", function () {
    if ((sel.val() !== null) && (sel2.val() !== null) && (sel3.val() !== null)) {
      $(this).html(`<i class="fa fa-spinner fa-spin "></i>`);
      $("#example").dataTable().fnDestroy();
      var table = $("#example").DataTable({
        buttons: [
          {
            extend: "excel",
            messageTop: "Powered by Koi Brother",
          },
        ],
        autoWidth: false,
        aLengthMenu: [
          [5, 10, 15, 25, 50, 100, -1],
          [5, 10, 15, 25, 50, 100, "All"],
        ],
        iDisplayLength: 5,
        ajax: {
          url: "{{url_for('cleanHtmlStatic')}}?comment="+sel.val()+"&month="+sel2.val()+"&year=" + sel3.val(),
          type: "GET",
        },
        createdRow: function (row, data, index) {
          $(row).addClass("selected");
        },
        fnInitComplete: function () {
          $("#showData").html("Show Data");
          $("#data-crawl").show();
        },
      });
    } else {
      alert("pilih dulu lah lek iya kali enggak !!");
    }
  });
$("#sentimentData").on("click", function () {
  console.log(sel2.val())
    if ((sel.val() !== null) && (sel2.val() !== null) && (sel3.val() !== null)) {
      $(this).html(`<i class="fa fa-spinner fa-spin "></i>`);
      $("#sentimentDataTable").dataTable().fnDestroy();
      var table = $("#sentimentDataTable").DataTable({
        buttons: [
          {
            extend: "excel",
            messageTop: "Powered by Koi Brother",
          },
        ],
        autoWidth: false,
        aLengthMenu: [
          [5, 10, 15, 25, 50, 100, -1],
          [5, 10, 15, 25, 50, 100, "All"],
        ],
        iDisplayLength: 5,
        ajax: {
          url: "{{url_for('sentimentAnalystStatic')}}?comment="+sel.val()+"&month="+sel2.val()+"&year=" + sel3.val(),
          type: "GET",
        },
        createdRow: function (row, data, index) {
          $(row).addClass("selected");
        },
        fnInitComplete: function () {
          $("#sentimentData").html("Analisis Sentimen");
          $("#data-sent").show();
        },
      });
    } else {
      alert("pilih dulu lah lek iya kali enggak !!");
    }
  });
</script>
{% endblock%}
